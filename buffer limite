#define NUM_ITEMS 32
#define BUFSIZE 8
 
Static struct pt_sem cheio, vazio;
 
estático 
PT_THREAD (produtor (struct pt * pt))
{
  Int estático produzido;
  
  PT_BEGIN (pt);
  
  Para (produzido = 0; produzido <NUM_ITEMS; ++ produzido) {
  
    PT_SEM_WAIT (pt, & full);
    
    Add_to_buffer (product_item ());    
    
    PT_SEM_SIGNAL (pt, & empty);
  }
 
  PT_END (pt);
}
 
estático 
PT_THREAD (consumidor (struct pt * pt))
{
  Int estático consumido;
  
  PT_BEGIN (pt);
 
  Para (consumido = 0; consumido <NUM_ITEMS; ++ consumido) {
    
    PT_SEM_WAIT (pt, & empty);
    
    Consume_item (get_from_buffer ());    
    
    PT_SEM_SIGNAL (pt, & full);
  }
 
  PT_END (pt);
}
 
estático 
PT_THREAD (driver_thread (struct pt * pt))
{
  Static struct pt pt_producer, pt_consumer;
 
  PT_BEGIN (pt);
  
  PT_SEM_INIT (& empty, 0);
  PT_SEM_INIT (& full, BUFSIZE);
 
  PT_INIT (& pt_producer);
  PT_INIT (& pt_consumer);
 
  PT_WAIT_THREAD (pt, produtor (& pt_producer) &
		     Consumidor (& pt_consumer));
 
  PT_END (pt);
}
